-- Create database
CREATE DATABASE IF NOT EXISTS weather_label_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE weather_label_db;

-- Monitoring stations table
CREATE TABLE IF NOT EXISTS stations (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    longitude DECIMAL(10, 7) NOT NULL,
    latitude DECIMAL(10, 7) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_coordinates (longitude, latitude)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Images table
CREATE TABLE IF NOT EXISTS images (
    id INT AUTO_INCREMENT PRIMARY KEY,
    filename VARCHAR(255) NOT NULL UNIQUE,
    filepath VARCHAR(512) NOT NULL,
    uploaded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    annotated BOOLEAN DEFAULT FALSE,
    INDEX idx_annotated (annotated)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Annotations table
CREATE TABLE IF NOT EXISTS annotations (
    id INT AUTO_INCREMENT PRIMARY KEY,
    image_id INT NOT NULL,
    category ENUM('积劳', '大雾', '结冰') NOT NULL,
    severity ENUM('无', '轻度', '中度', '重度') NOT NULL,
    observation_time DATETIME NOT NULL,
    location VARCHAR(255) NOT NULL,
    longitude DECIMAL(10, 7) NOT NULL,
    latitude DECIMAL(10, 7) NOT NULL,
    station_id INT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (image_id) REFERENCES images(id) ON DELETE CASCADE,
    FOREIGN KEY (station_id) REFERENCES stations(id),
    UNIQUE KEY unique_image_annotation (image_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Insert sample monitoring stations (150 stations across various regions in China)
INSERT INTO stations (name, longitude, latitude) VALUES
('北京市气象站', 116.4074, 39.9042),
('上海市气象站', 121.4737, 31.2304),
('广州市气象站', 113.2644, 23.1291),
('深圳市气象站', 114.0579, 22.5431),
('成都市气象站', 104.0668, 30.5728),
('杭州市气象站', 120.1551, 30.2741),
('重庆市气象站', 106.5516, 29.5630),
('西安市气象站', 108.9398, 34.3416),
('苏州市气象站', 120.5954, 31.2989),
('武汉市气象站', 114.3055, 30.5931),
('天津市气象站', 117.2008, 39.0842),
('南京市气象站', 118.7969, 32.0603),
('长沙市气象站', 112.9388, 28.2282),
('郑州市气象站', 113.6254, 34.7466),
('沈阳市气象站', 123.4328, 41.8057),
('青岛市气象站', 120.3826, 36.0671),
('大连市气象站', 121.6147, 38.9140),
('济南市气象站', 117.1205, 36.6519),
('哈尔滨市气象站', 126.5349, 45.8038),
('福州市气象站', 119.2965, 26.0745),
('厦门市气象站', 118.0894, 24.4798),
('昆明市气象站', 102.8329, 24.8801),
('兰州市气象站', 103.8343, 36.0611),
('太原市气象站', 112.5489, 37.8706),
('石家庄市气象站', 114.5149, 38.0428),
('南昌市气象站', 115.8581, 28.6832),
('贵阳市气象站', 106.7135, 26.5783),
('南宁市气象站', 108.3661, 22.8172),
('乌鲁木齐市气象站', 87.6168, 43.8256),
('拉萨市气象站', 91.1145, 29.6448),
('呼和浩特市气象站', 111.7498, 40.8414),
('银川市气象站', 106.2586, 38.4681),
('西宁市气象站', 101.7782, 36.6171),
('海口市气象站', 110.3312, 20.0311),
('三亚市气象站', 109.5082, 18.2528),
('宁波市气象站', 121.5440, 29.8683),
('温州市气象站', 120.6994, 28.0006),
('合肥市气象站', 117.2272, 31.8206),
('珠海市气象站', 113.5765, 22.2707),
('东莞市气象站', 113.7518, 23.0208),
('佛山市气象站', 113.1220, 23.0219),
('无锡市气象站', 120.3119, 31.4912),
('常州市气象站', 119.9739, 31.8109),
('徐州市气象站', 117.2838, 34.2044),
('烟台市气象站', 121.4478, 37.4638),
('潍坊市气象站', 119.1619, 36.7067),
('淄博市气象站', 118.0548, 36.8131),
('威海市气象站', 122.1206, 37.5097),
('扬州市气象站', 119.4121, 32.3932),
('泰州市气象站', 119.9229, 32.4849),
('南通市气象站', 120.8945, 31.9809),
('盐城市气象站', 120.1633, 33.3497),
('连云港市气象站', 119.2216, 34.5969),
('淮安市气象站', 119.1139, 33.5528),
('宿迁市气象站', 118.2752, 33.9631),
('镇江市气象站', 119.4252, 32.1873),
('保定市气象站', 115.4648, 38.8736),
('唐山市气象站', 118.1802, 39.6303),
('邯郸市气象站', 114.5391, 36.6253),
('秦皇岛市气象站', 119.6004, 39.9354),
('邢台市气象站', 114.5086, 37.0695),
('张家口市气象站', 114.8869, 40.8118),
('承德市气象站', 117.9634, 40.9517),
('沧州市气象站', 116.8387, 38.3037),
('廊坊市气象站', 116.6838, 39.5376),
('衡水市气象站', 115.6706, 37.7389),
('长春市气象站', 125.3235, 43.8171),
('吉林市气象站', 126.5493, 43.8378),
('四平市气象站', 124.3505, 43.1703),
('辽源市气象站', 125.1437, 42.8876),
('通化市气象站', 125.9397, 41.7282),
('白山市气象站', 126.4275, 41.9425),
('松原市气象站', 124.8254, 45.1411),
('白城市气象站', 122.8397, 45.6196),
('大庆市气象站', 125.1032, 46.5900),
('齐齐哈尔市气象站', 123.9539, 47.3476),
('鸡西市气象站', 130.9697, 45.2950),
('鹤岗市气象站', 130.2977, 47.3498),
('双鸭山市气象站', 131.1592, 46.6434),
('牡丹江市气象站', 129.6327, 44.5518),
('佳木斯市气象站', 130.3184, 46.7993),
('七台河市气象站', 130.8506, 45.7709),
('伊春市气象站', 128.8997, 47.7248),
('黑河市气象站', 127.5286, 50.2442),
('绥化市气象站', 126.9689, 46.6384),
('抚顺市气象站', 123.9571, 41.8800),
('本溪市气象站', 123.7703, 41.2979),
('丹东市气象站', 124.3543, 40.0005),
('锦州市气象站', 121.1272, 41.0956),
('营口市气象站', 122.2353, 40.6672),
('阜新市气象站', 121.6708, 42.0211),
('辽阳市气象站', 123.2373, 41.2691),
('盘锦市气象站', 122.0709, 41.1191),
('铁岭市气象站', 123.7262, 42.2234),
('朝阳市气象站', 120.4507, 41.5736),
('葫芦岛市气象站', 120.8368, 40.7113),
('包头市气象站', 109.8403, 40.6576),
('乌海市气象站', 106.7944, 39.6550),
('赤峰市气象站', 118.8869, 42.2587),
('通辽市气象站', 122.2433, 43.6529),
('鄂尔多斯市气象站', 109.7810, 39.6086),
('呼伦贝尔市气象站', 119.7658, 49.2016),
('巴彦淖尔市气象站', 107.3874, 40.7574),
('乌兰察布市气象站', 113.1328, 40.9944),
('兴安盟气象站', 122.0382, 46.0763),
('锡林郭勒盟气象站', 116.0481, 43.9333),
('阿拉善盟气象站', 105.7287, 38.8448),
('克拉玛依市气象站', 84.8891, 45.5795),
('吐鲁番市气象站', 89.1815, 42.9513),
('哈密市气象站', 93.5151, 42.8185),
('昌吉州气象站', 87.3045, 44.0078),
('博尔塔拉州气象站', 82.0524, 44.9058),
('巴音郭楞州气象站', 86.1454, 41.7686),
('阿克苏地区气象站', 80.2651, 41.1707),
('克孜勒苏州气象站', 76.1679, 39.7151),
('喀什地区气象站', 75.9895, 39.4704),
('和田地区气象站', 79.9137, 37.1107),
('伊犁州气象站', 81.3246, 43.9171),
('塔城地区气象站', 82.9857, 46.7456),
('阿勒泰地区气象站', 88.1396, 47.8484),
('林芝市气象站', 94.3616, 29.6489),
('昌都市气象站', 97.1785, 31.1369),
('山南市气象站', 91.7731, 29.2370),
('日喀则市气象站', 88.8851, 29.2669),
('那曲市气象站', 92.0535, 31.4806),
('阿里地区气象站', 80.1055, 32.5011),
('曲靖市气象站', 103.7965, 25.4897),
('玉溪市气象站', 102.5437, 24.3704),
('保山市气象站', 99.1670, 25.1119),
('昭通市气象站', 103.7177, 27.3406),
('丽江市气象站', 100.2270, 26.8721),
('普洱市气象站', 100.9664, 22.8254),
('临沧市气象站', 100.0886, 23.8866),
('楚雄州气象站', 101.5457, 25.0411),
('红河州气象站', 103.3742, 23.3668),
('文山州气象站', 104.2449, 23.3695),
('西双版纳州气象站', 100.7979, 22.0017),
('大理州气象站', 100.2676, 25.6064),
('德宏州气象站', 98.5844, 24.4331),
('怒江州气象站', 98.8567, 25.8509),
('迪庆州气象站', 99.7065, 27.8269),
('遵义市气象站', 106.9272, 27.7056),
('安顺市气象站', 105.9476, 26.2455),
('毕节市气象站', 105.2863, 27.3017),
('铜仁市气象站', 109.1897, 27.7183),
('黔西南州气象站', 104.9058, 25.0881),
('黔东南州气象站', 107.9774, 26.5839),
('黔南州气象站', 107.5223, 26.2582);
